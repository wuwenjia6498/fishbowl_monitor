# ä»»åŠ¡ï¼šè¡Œä¸šæ¿å—å¢åŠ â€œåŒºé—´æ¶¨å¹…â€å­—æ®µ (v7.1 Interval Change)

ç”¨æˆ·å¸Œæœ› **[è¡Œä¸šè½®åŠ¨]** è¡¨æ ¼èƒ½å’Œ **[å®½åŸºå¤§åŠ¿]** è¡¨æ ¼ä¿æŒä¸€è‡´ï¼Œå¢åŠ  **"åŒºé—´æ¶¨å¹…"** å­—æ®µã€‚
è¯¥å­—æ®µç”¨äºè¡¡é‡å½“å‰çš„è¶‹åŠ¿å¼ºåº¦ï¼ˆé€šå¸¸å®šä¹‰ä¸ºè¿‘ 20 æ—¥æ¶¨å¹…ï¼Œæˆ–ä¸å®½åŸºæŒ‡æ•°ä¿æŒä¸€è‡´çš„è®¡ç®—é€»è¾‘ï¼‰ã€‚

## 1. åç«¯ ETL é€»è¾‘åŒæ­¥ (`scripts/etl.py`)

è¯·æ£€æŸ¥è¡Œä¸šæ•°æ®çš„è®¡ç®—é€»è¾‘ï¼Œç¡®ä¿è®¡ç®—å¹¶è¿”å›äº† `range_chg_pct` (æˆ– `interval_chg`) å­—æ®µã€‚

**è®¡ç®—é€»è¾‘è¦æ±‚ï¼š**
1.  **å‚è€ƒæ ‡å‡†:** æŸ¥é˜…ä»£ç ä¸­è®¡ç®—â€œå®½åŸºæŒ‡æ•°åŒºé—´æ¶¨å¹…â€çš„é€»è¾‘ï¼Œå®Œå…¨å¤ç”¨è¯¥å…¬å¼ã€‚
2.  **é€šç”¨ç®—æ³• (å¦‚æœæ‰¾ä¸åˆ°å‚è€ƒ):**
    * è®¡ç®— **(ä»Šæ—¥æ”¶ç›˜ä»· - 20ä¸ªäº¤æ˜“æ—¥å‰æ”¶ç›˜ä»·) / 20ä¸ªäº¤æ˜“æ—¥å‰æ”¶ç›˜ä»·**ã€‚
    * *æˆ–è€…:* å¦‚æœç­–ç•¥å®šä¹‰ä¸ºâ€œè‡ªä¿¡å·å‘å‡ºä»¥æ¥çš„æ¶¨å¹…â€ï¼Œåˆ™è®¡ç®— (ä»Šæ—¥æ”¶ç›˜ - ä¿¡å·ç¿»è½¬æ—¥æ”¶ç›˜) / ä¿¡å·ç¿»è½¬æ—¥æ”¶ç›˜ã€‚
    * **å»ºè®®é»˜è®¤:** `pct_chg_20d` (è¿‘20æ—¥ç´¯è®¡æ¶¨å¹…)ã€‚
3.  **æ•°æ®å†™å…¥:** ç¡®ä¿è¯¥å­—æ®µè¢«å†™å…¥æ•°æ®åº“æˆ– JSON ç»“æœä¸­ã€‚

## 2. å‰ç«¯åˆ—å®šä¹‰æ·»åŠ  (`components/columns.tsx`)

è¯·åœ¨ **è¡Œä¸šè¡¨æ ¼ (Industry Columns)** çš„å®šä¹‰ä¸­å¢åŠ ä¸€åˆ—ã€‚

**ä½ç½®å»ºè®®ï¼š**
æ”¾åœ¨ **"å½“æ—¥æ¶¨å¹…"** ä¹‹åï¼Œæˆ– **"åç¦»åº¦"** ä¹‹å‰ã€‚

**ä»£ç é€»è¾‘è¦æ±‚ (UI è§„èŒƒ):**
1.  **å­—æ®µå:** `range_chg_pct` (éœ€ä¸åç«¯å¯¹é½)ã€‚
2.  **è¡¨å¤´:** "åŒºé—´æ¶¨å¹…" (æ”¯æŒæ’åº)ã€‚
3.  **æ ·å¼ (v6.3 å®ªæ³•):**
    * **> 0:** ğŸ”´ `text-red-500` (åŠ  `+` å·)
    * **< 0:** ğŸŸ¢ `text-green-500`
    * **æ ¼å¼:** ä¿ç•™ 2 ä½å°æ•° (ä¾‹å¦‚ `+5.42%`)ã€‚

**ä»£ç ç‰‡æ®µå‚è€ƒ:**
```tsx
{
  accessorKey: "range_chg_pct",
  header: ({ column }) => (
    <DataTableColumnHeader column={column} title="åŒºé—´æ¶¨å¹…" />
  ),
  cell: ({ row }) => {
    // å®¹é”™å¤„ç†ï¼šå¦‚æœæ²¡æœ‰è¯¥å­—æ®µï¼Œæ˜¾ç¤º --
    const val = row.getValue("range_chg_pct");
    if (val === null || val === undefined) return <div className="text-muted-foreground">--</div>;
    
    const value = parseFloat(val as string);
    const colorClass = value > 0 
      ? "text-red-500 font-medium" 
      : value < 0 
        ? "text-green-500 font-medium" 
        : "text-muted-foreground";
    
    const displayValue = value > 0 ? `+${value.toFixed(2)}%` : `${value.toFixed(2)}%`;

    return <div className={colorClass}>{displayValue}</div>;
  },
},

æ‰§è¡ŒæŒ‡ä»¤
Backend: ç¡®è®¤ etl.py ä¸­è¡Œä¸šæ•°æ®å·²åŒ…å«åŒºé—´æ¶¨å¹…è®¡ç®—ã€‚

Frontend: ä¿®æ”¹ components/columns.tsxï¼Œåœ¨è¡Œä¸šè¡¨ä¸­æ·»åŠ â€œåŒºé—´æ¶¨å¹…â€åˆ—ã€‚