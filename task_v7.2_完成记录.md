# v7.2 ä»»åŠ¡å®Œæˆè®°å½•

## ä»»åŠ¡ç›®æ ‡
ä¸º**è¡Œä¸šæ¿å—**è¡¨æ ¼å¢åŠ "æŒç»­å¤©æ•°"å­—æ®µï¼Œä¸å®½åŸºæŒ‡æ•°ä¿æŒä¸€è‡´ã€‚

## æ‰§è¡Œæƒ…å†µ

### âœ… åç«¯æ£€æŸ¥ (`scripts/etl.py`)
**çŠ¶æ€**ï¼šæ— éœ€ä¿®æ”¹ï¼Œå·²å®Œæˆ

- âœ… ETL è„šæœ¬å·²è®¡ç®— `duration_days` å­—æ®µï¼ˆç¬¬336-399è¡Œï¼‰
- âœ… æ•°æ®å·²å†™å…¥æ•°æ®åº“ï¼ˆç¬¬644-703è¡Œï¼‰
- âœ… è®¡ç®—é€»è¾‘ï¼š
  ```python
  for i in range(len(df)):
      close = df.loc[i, 'close']
      ma20 = df.loc[i, 'ma20_price']
      
      if i == 0:
          # ç¬¬ä¸€å¤©åˆå§‹åŒ–
          status = 'YES' if close >= ma20 else 'NO'
          duration = 1
      else:
          prev_status = statuses[-1]
          prev_duration = durations[-1]
          
          # åº”ç”¨ç¼“å†²å¸¦é€»è¾‘åˆ¤æ–­çŠ¶æ€
          # ...
          
          # è®¡ç®—æŒç»­å¤©æ•°
          duration = 1 if prev_status != status else prev_duration + 1
      
      statuses.append(status)
      durations.append(duration)
  ```

### âœ… å‰ç«¯ä¿®æ”¹ (`components/business/fishbowl-table.tsx`)
**çŠ¶æ€**ï¼šå·²å®Œæˆ

#### 1. æ·»åŠ è¡¨å¤´åˆ—ï¼ˆç¬¬580-586è¡Œï¼‰
```tsx
<TableHead className="w-[100px]">
  <HeaderWithTooltip
    title="æŒç»­å¤©æ•°"
    content="å½“å‰è¶‹åŠ¿è¿ç»­ç»´æŒçš„äº¤æ˜“æ—¥æ•°é‡ã€‚"
    align="center"
  />
</TableHead>
```

#### 2. æ·»åŠ æ•°æ®å•å…ƒæ ¼ï¼ˆç¬¬769-775è¡Œï¼‰
```tsx
{/* v7.2: æŒç»­å¤©æ•°ï¼ˆç…§æ¬å®½åŸºæŒ‡æ•°å®ç°ï¼‰ */}
<TableCell className="w-[100px] text-center">
  <span className={`font-mono font-medium ${item.signal_tag === 'BREAKOUT' ? 'text-red-600' : ''}`}>
    {item.duration_days}
  </span>
</TableCell>
```

## å®ç°ç»†èŠ‚

### è®¡ç®—é€»è¾‘ï¼ˆä¸å®½åŸºæŒ‡æ•°å®Œå…¨ä¸€è‡´ï¼‰
1. **çŠ¶æ€ä¸å˜**ï¼š`duration = prev_duration + 1`
2. **çŠ¶æ€åè½¬**ï¼š`duration = 1`ï¼ˆæ–°è¶‹åŠ¿çš„ç¬¬ä¸€å¤©ï¼‰
3. **åˆå§‹åŒ–**ï¼šé¦–æ¬¡è®¡ç®—æ—¶ `duration = 1`

### æ ·å¼è§„èŒƒ
- âœ… **å±…ä¸­æ˜¾ç¤º**ï¼š`text-center`
- âœ… **ç­‰å®½å­—ä½“**ï¼š`font-mono font-medium`
- âœ… **ç‰¹æ®Šæ ‡è®°**ï¼š`BREAKOUT` ä¿¡å·ï¼ˆå¯åŠ¨ï¼‰æ—¶æ˜¾ç¤ºçº¢è‰²é«˜äº®
- âœ… **æ”¯æŒæ’åº**ï¼šé€šè¿‡ `HeaderWithTooltip` ç»„ä»¶è‡ªåŠ¨æ”¯æŒ

### åˆ—é¡ºåºï¼ˆè¡Œä¸šæ¿å—è¡¨æ ¼ï¼‰
```
æ¿å—åç§° â†’ ETFæ ‡çš„ â†’ é€»è¾‘ â†’ æŒä»“ â†’ è¿‘æœŸè¶‹åŠ¿ â†’ ç°ä»·&MA20 
â†’ å½“æ—¥æ¶¨å¹… â†’ çŠ¶æ€ â†’ [æŒç»­å¤©æ•° ğŸ†•] â†’ åŒºé—´æ¶¨å¹… â†’ åç¦»åº¦
```

## åŠŸèƒ½ç‰¹æ€§

### 1. è§†è§‰æç¤º
- **æ™®é€šçŠ¶æ€**ï¼šé»‘è‰²ç­‰å®½å­—ä½“æ˜¾ç¤ºå¤©æ•°ï¼ˆå¦‚ `15`ï¼‰
- **å¯åŠ¨ä¿¡å·**ï¼ˆBREAKOUTï¼‰ï¼šçº¢è‰²é«˜äº®æ˜¾ç¤ºï¼ˆå¦‚ `3`ï¼‰ï¼Œæç¤ºæ–°è¶‹åŠ¿åˆšå¯åŠ¨

### 2. æ’åºåŠŸèƒ½
- âœ… ç‚¹å‡»è¡¨å¤´å¯æŒ‰æŒç»­å¤©æ•°å‡åº/é™åºæ’åº
- âœ… æ–¹ä¾¿ç”¨æˆ·ç­›é€‰ï¼š
  - **è€å¦–è‚¡**ï¼šæŒç»­å¤©æ•°é•¿çš„æ¿å—ï¼ˆè¶‹åŠ¿ç¨³å›ºï¼‰
  - **æ–°å¯åŠ¨**ï¼šæŒç»­å¤©æ•°çŸ­çš„æ¿å—ï¼ˆåˆšçªç ´ï¼‰

### 3. æ•°æ®ç”¨é€”
- **è¶‹åŠ¿å¼ºåº¦**ï¼šæŒç»­å¤©æ•°è¶Šé•¿ï¼Œè¶‹åŠ¿è¶Šç¨³å›º
- **é£é™©æç¤º**ï¼šæŒç»­å¤©æ•°è¿‡é•¿ï¼ˆ>30å¤©ï¼‰å¯èƒ½é¢ä¸´å›è°ƒé£é™©
- **æœºä¼šå‘ç°**ï¼šæŒç»­å¤©æ•° 1-3 å¤©çš„ BREAKOUT ä¿¡å·æ˜¯æœ€ä½³å…¥åœºæ—¶æœº

## éªŒè¯ç»“æœ

- âœ… TypeScript ç¼–è¯‘é€šè¿‡ï¼ˆæ—  linter é”™è¯¯ï¼‰
- âœ… é€»è¾‘å®Œå…¨ç…§æ¬å®½åŸºæŒ‡æ•°å®ç°
- âœ… æ ·å¼ä¸é…è‰²ä¿æŒä¸€è‡´
- âœ… Tooltip æç¤ºä¿¡æ¯æ¸…æ™°
- âœ… æ”¯æŒæ’åºåŠŸèƒ½

## æ•ˆæœé¢„è§ˆ

### å®½åŸºæŒ‡æ•°è¡¨æ ¼ï¼ˆå‚è€ƒæ ‡å‡†ï¼‰
```
æŒç»­å¤©æ•°: 15    ï¼ˆé»‘è‰²ï¼Œç­‰å®½å­—ä½“ï¼‰
æŒç»­å¤©æ•°: 3     ï¼ˆçº¢è‰²ï¼ŒBREAKOUT ä¿¡å·ï¼‰
æŒç»­å¤©æ•°: 42    ï¼ˆé»‘è‰²ï¼Œé•¿æœŸè¶‹åŠ¿ï¼‰
```

### è¡Œä¸šæ¿å—è¡¨æ ¼ï¼ˆæ–°å¢ï¼‰
```
æŒç»­å¤©æ•°: 8     ï¼ˆé»‘è‰²ï¼Œç­‰å®½å­—ä½“ï¼‰
æŒç»­å¤©æ•°: 2     ï¼ˆçº¢è‰²ï¼ŒBREAKOUT ä¿¡å·ï¼‰
æŒç»­å¤©æ•°: 25    ï¼ˆé»‘è‰²ï¼Œç¨³å›ºè¶‹åŠ¿ï¼‰
```

## ç”¨æˆ·åœºæ™¯

### åœºæ™¯ 1ï¼šå¯»æ‰¾ç¨³å®šè¶‹åŠ¿
**æ“ä½œ**ï¼šç‚¹å‡»"æŒç»­å¤©æ•°"åˆ—å¤´ï¼ŒæŒ‰é™åºæ’åº  
**ç»“æœ**ï¼šæŒç»­å¤©æ•°æœ€é•¿çš„æ¿å—æ’åœ¨æœ€å‰é¢  
**ç”¨é€”**ï¼šæ‰¾åˆ°è¶‹åŠ¿æœ€ç¨³å›ºçš„æ¿å—ï¼Œé€‚åˆè¶‹åŠ¿è·Ÿéšç­–ç•¥

### åœºæ™¯ 2ï¼šæ•æ‰å¯åŠ¨ä¿¡å·
**æ“ä½œ**ï¼šç‚¹å‡»"æŒç»­å¤©æ•°"åˆ—å¤´ï¼ŒæŒ‰å‡åºæ’åº  
**ç»“æœ**ï¼šåˆšå¯åŠ¨çš„æ¿å—ï¼ˆ1-3å¤©ï¼‰æ’åœ¨æœ€å‰é¢  
**ç”¨é€”**ï¼šæ‰¾åˆ°æ–°çªç ´çš„æ¿å—ï¼Œé€‚åˆæ—©æœŸä»‹å…¥

### åœºæ™¯ 3ï¼šé£é™©é¢„è­¦
**æ“ä½œ**ï¼šæµè§ˆæŒç»­å¤©æ•° >30 å¤©çš„æ¿å—  
**ç»“æœ**ï¼šè¯†åˆ«å¯èƒ½è¿‡åº¦å»¶ä¼¸çš„è¶‹åŠ¿  
**ç”¨é€”**ï¼šæé†’æ³¨æ„è·åˆ©äº†ç»“æˆ–é™ä½ä»“ä½

## ä¸å®½åŸºæŒ‡æ•°å¯¹æ¯”

| ç‰¹æ€§ | å®½åŸºæŒ‡æ•° | è¡Œä¸šæ¿å— |
|------|----------|----------|
| **å­—æ®µå** | `duration_days` | `duration_days` âœ… |
| **è®¡ç®—é€»è¾‘** | çŠ¶æ€ä¸å˜ +1ï¼Œåè½¬é‡ç½® | å®Œå…¨ä¸€è‡´ âœ… |
| **æ˜¾ç¤ºä½ç½®** | çŠ¶æ€ä¹‹å | çŠ¶æ€ä¹‹å âœ… |
| **æ ·å¼** | å±…ä¸­ï¼Œç­‰å®½å­—ä½“ | å®Œå…¨ä¸€è‡´ âœ… |
| **BREAKOUT é«˜äº®** | çº¢è‰² | çº¢è‰² âœ… |
| **æ”¯æŒæ’åº** | âœ… | âœ… |
| **Tooltip** | "å½“å‰è¶‹åŠ¿è¿ç»­ç»´æŒçš„äº¤æ˜“æ—¥æ•°é‡" | å®Œå…¨ä¸€è‡´ âœ… |

---

**å®Œæˆæ—¶é—´**ï¼š2025-12-29  
**ç‰ˆæœ¬**ï¼šv7.2  
**çŠ¶æ€**ï¼šâœ… å·²å®Œæˆï¼Œå¾…ç”¨æˆ·éªŒè¯  
**æµ‹è¯•å»ºè®®**ï¼šåˆ·æ–°é¡µé¢ï¼Œå°è¯•ç‚¹å‡»"æŒç»­å¤©æ•°"åˆ—å¤´è¿›è¡Œæ’åº

